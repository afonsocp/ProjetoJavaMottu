<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Devolu√ß√£o - NeoMoto</title>
    <meta charset="UTF-8">
    <style>
        .form-container { max-width: 600px; margin: 20px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .error { color: red; font-size: 0.9em; }
        .btn { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; }
        .btn:hover { background: #0056b3; }
        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #545b62; }
        .info-box { background: #e7f3ff; border: 1px solid #b3d7ff; padding: 15px; border-radius: 4px; margin-bottom: 20px; }
        .warning-box { background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 4px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="form-container">
        <h1>üîÑ Devolu√ß√£o de Moto</h1>
        
        <div class="info-box">
            <h3>üìã Dados da Aloca√ß√£o</h3>
            <p><strong>Moto:</strong> <span th:text="${alocacao.moto.placa} + ' - ' + ${alocacao.moto.modelo}">ABC1234 - Honda CG 160</span></p>
            <p><strong>Motorista:</strong> <span th:text="${alocacao.motorista.nome}">Jo√£o Silva</span></p>
            <p><strong>Sa√≠da:</strong> <span th:text="${#temporals.format(alocacao.dataHoraSaida, 'dd/MM/yyyy HH:mm')}">15/01/2024 08:00</span></p>
            <p><strong>P√°tio Origem:</strong> <span th:text="${alocacao.patioOrigem.nome}">Centro</span></p>
            <p><strong>KM na Sa√≠da:</strong> <span th:text="${alocacao.moto.kmAtual}">15000</span> km</p>
        </div>
        
        <div class="warning-box">
            <strong>‚ö†Ô∏è Aten√ß√£o:</strong> Verifique as condi√ß√µes da moto antes de finalizar a devolu√ß√£o. 
            Se houver problemas, considere abrir uma manuten√ß√£o.
        </div>
        
        <form th:action="@{/alocacoes/{id}/devolucao(id=${alocacao.id})}" th:object="${devolucaoForm}" method="post">
            
            <div class="form-group">
                <label for="patioDevolucaoId">P√°tio de Devolu√ß√£o:</label>
                <select th:field="*{patioDevolucaoId}" id="patioDevolucaoId" required>
                    <option value="">Selecione um p√°tio</option>
                    <option th:each="patio : ${patios}" 
                            th:value="${patio.id}" 
                            th:text="${patio.nome} + ' - ' + ${patio.endereco}">
                        Centro - Rua das Flores, 123
                    </option>
                </select>
                <div class="error" th:if="${#fields.hasErrors('patioDevolucaoId')}" th:errors="*{patioDevolucaoId}"></div>
            </div>
            
            <div class="form-group">
                <label for="kmDevolucao">KM Atual (opcional):</label>
                <input type="number" th:field="*{kmDevolucao}" id="kmDevolucao" 
                       th:min="${alocacao.moto.kmAtual}" 
                       placeholder="Informe o KM atual se diferente do registrado" />
                <small>Deixe em branco se n√£o houve mudan√ßa significativa no KM</small>
                <div class="error" th:if="${#fields.hasErrors('kmDevolucao')}" th:errors="*{kmDevolucao}"></div>
            </div>
            
            <div class="form-group">
                <label for="checklistDevolucao">Checklist de Devolu√ß√£o:</label>
                <textarea th:field="*{checklistDevolucao}" id="checklistDevolucao" rows="4" 
                          placeholder="Descreva as condi√ß√µes da moto na devolu√ß√£o: danos, n√≠vel de combust√≠vel, limpeza, etc." required></textarea>
                <div class="error" th:if="${#fields.hasErrors('checklistDevolucao')}" th:errors="*{checklistDevolucao}"></div>
            </div>
            
            <div style="margin-top: 20px;">
                <button type="submit" class="btn">‚úÖ Finalizar Devolu√ß√£o</button>
                <a th:href="@{/alocacoes}" class="btn btn-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</body>
</html>
